<!doctype html>
<html lang="en" >

<head>
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<meta name="theme-color" content="#3F51B5">
	<title>Chess AI</title>
	<meta name="mobile-web-app-capable" content="yes"><!-- <link rel="icon" sizes="192x192" href="/icons/appicon.png"> -->
	<link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
	<link rel="stylesheet" href="https://code.getmdl.io/1.1.2/material.indigo-blue.min.css">
	<script defer src="https://code.getmdl.io/1.1.2/material.min.js"></script>
	<script src="https://code.jquery.com/jquery-2.1.4.min.js"></script>
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/materialize/0.97.5/css/materialize.min.css">
	<script src="https://cdnjs.cloudflare.com/ajax/libs/materialize/0.97.5/js/materialize.min.js"></script>
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.2.0/jquery.min.js"></script>
	<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
</head>

<style>
	body {margin: 20px; line-height: 100%;}
</style>

<body ng-app="BlankApp" ng-cloak>

<script>
//init board positionning
var xboard = 2
var yboard = 2
var cellsize = 30
// mouse coordinates for move, between 0 and 7 (init at -1 when not displayed) 
var startx = -1
var starty = -1
var stopx = -1
var stopy = -1
var startstop = 1 // 1 for start, -1 for stop
//list of legal moves
var legalmoveslist = [];
</script>

<!-- board material hidden preload-->	
<div  style="display:none;">
	<img id="Bbishop" src="B-bishop.svg">
	<img id="Bking" src="B-king.svg">
	<img id="Bknight" src="B-knight.svg">
	<img id="Bpawn" src="B-pawn.svg">
	<img id="Bqueen" src="B-queen.svg">
	<img id="Brook" src="B-rook.svg">
	<img id="Wbishop" src="W-bishop.svg">
	<img id="Wking" src="W-king.svg">
	<img id="Wknight" src="W-knight.svg">
	<img id="Wpawn" src="W-pawn.svg">
	<img id="Wqueen" src="W-queen.svg">
	<img id="Wrook" src="W-rook.svg">
</div>

<!-- board -->
	<div id="board_div">
	<canvas id="myBoard" width=300 height=268></canvas>
	</div>
<!-- chart -->
	<div id="chart_div" style="display:none;"></div>
<!-- buttons -->
	<p>
	<button class="mdl-button mdl-js-button mdl-button--raised mdl-js-ripple-effect" onclick="validatemove()">Move</button>
	<button class="mdl-button mdl-js-button mdl-button--ico" id="showhidestats"><i class="material-icons">timeline</i></button>
	</p>


<!-- prod scripts from JS fodler -->
<script src="/chess/js/statschart.js"></script>
<script src="/chess/js/mouseclick.js"></script>
<script src="/chess/js/renderboard.js"></script>
<script src="/chess/js/initboard.js"></script>

<!-- dev scripts -->

<script>
//genric string comparison function
// Warn if overriding existing method
if(Array.prototype.equals)
    console.warn("Overriding existing Array.prototype.equals. Possible causes: New API defines the method, there's a framework conflict or you've got double inclusions in your code.");
// attach the .equals method to Array's prototype to call it on any array
Array.prototype.equals = function (array) {
    // if the other array is a falsy value, return
    if (!array)
        return false;

    // compare lengths - can save a lot of time 
    if (this.length != array.length)
        return false;

    for (var i = 0, l=this.length; i < l; i++) {
        // Check if we have nested arrays
        if (this[i] instanceof Array && array[i] instanceof Array) {
            // recurse into the nested arrays
            if (!this[i].equals(array[i]))
                return false;       
        }           
        else if (this[i] != array[i]) { 
            // Warning - two different object instances will never be equal: {x:20} != {x:20}
            return false;   
        }           
    }       
    return true;
}
// Hide method from for-in loops
Object.defineProperty(Array.prototype, "equals", {enumerable: false});
</script>


<script>

function listlegalmoves()
{
	//init
	legalmoveslist = [];
	//append all possibilities
	legalmoveslist = legalmoveslist.concat([[1,2,3,4]])
	legalmoveslist = legalmoveslist.concat([[6,3,4,3]])
}
function validatemove()
{
	listlegalmoves();
	var passedtest = 0;
	var candidatemove = [];
	candidatemove = candidatemove.concat([[starty,startx,stopy,stopx]])
	
	for (lilegal = 0; lilegal < legalmoveslist.length; lilegal++) 
	{ 
		if (legalmoveslist[lilegal].equals(candidatemove[0])) 
			{
			passedtest = 1
			}
	}
	
	if (passedtest == 1)
	{
		//make move in matrix and render
		matrix[stopy][stopx] = matrix[starty][startx]
		matrix[starty][startx] = 0
		drawboard();
		drawmaterial();
		//update chart for stats
		var currentrank = (matrix.reduce(function(a,b) { return a.concat(b) }).reduce(function(a,b) { return a + b })).toFixed(2)
		mydata.push([myturn,currentrank])
		myturn=myturn+1;
		drawChart();
	} else {
		var snackbarContainer = document.querySelector('#demo-toast-example');
	  	var showToastButton = document.querySelector('#demo-show-toast');
	  	var data = {message: 'Move not allowed'};
	    	snackbarContainer.MaterialSnackbar.showSnackbar(data);
	}

};	
</script>

</body>
<!-- snackbar -->
	<center>
	<div id="demo-toast-example" class="mdl-js-snackbar mdl-snackbar">
	  <div class="mdl-snackbar__text"></div>
	  <button class="mdl-snackbar__action" type="button"></button>
	</div>
	<center>
</html>
